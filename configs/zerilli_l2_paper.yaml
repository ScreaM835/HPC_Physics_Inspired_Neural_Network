# Faithful reproduction of Patel, Aykutalp & Laguna (2024), arXiv:2401.01440
# All settings match the paper's Section 5 as closely as possible.
experiment:
  name: zerilli_l2_paper

physics:
  M: 1.0
  l: 2
  potential: zerilli
  pde_sign: standard

domain:
  xmin: -50.0
  xmax: 150.0
  tmin: 0.0
  tmax: 50.0

initial_data:
  A: 1.0
  x0: 4.0
  sigma: 5.0
  # Paper Eq. 23: Phi_t = 2*(x-x0)^2/sigma^2 * Phi
  velocity_profile: paper

fd:
  dx: 0.2
  dt: 0.1
  scheme: rk4_mol

pinn:
  seed: 1234
  dtype: float64
  chunk_size: 4096

  # Training points (paper Section 5)
  Nr: 32000
  Ni: 800
  Nb: 400

  # Network (paper Section 5): [80, 40, 20, 10], tanh, Glorot uniform
  hidden_layers: [80, 40, 20, 10]
  activation: tanh
  output_transform: tanh_bound

  # Paper Section 5: lambda = [100, 100, 100, 1, 100, 1, 1]
  # "The weight lambda_iv = 100 is because of the phase problem"
  lambda: [100.0, 100.0, 100.0, 1.0, 100.0, 1.0, 1.0]

  # Not used in the paper
  causal:
    enabled: false

  # Not used in the paper
  gradient_balancing:
    enabled: false

  # Paper Section 5: Adam 10k + L-BFGS 15k, resample every 100
  adam:
    lr: 1.0e-3
    iters: 10000
    resample_period: 100

  lbfgs:
    iters: 15000
    resample_period: 100

evaluation:
  xq: 10.0

qnm:
  t_start: 10.0
  t_end: 50.0
